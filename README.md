AutoSecOps: A Simple Security Information and Event Management Tool
Project Overview

AutoSecOps is a lightweight Security Information and Event Management (SIEM) tool built with Python and Flask. This single-file application is designed for educational and small-scale use cases, allowing you to ingest and analyze log data to detect potential security threats.

The core functionality includes:

    Log Ingestion: Automatically monitors a designated directory for new log files and ingests their content into a SQLite database.

    YARA Rule Detection: Uses YARA, a powerful pattern-matching tool, to scan logs for malicious or suspicious activity.

    Correlation Engine: Applies configurable rules (threshold and window_seconds) to correlate log events and trigger alerts when suspicious patterns are detected over time.

    Dashboard & Analytics: Provides a web-based dashboard to view triggered alerts and a powerful integration with Gemini AI to generate automated incident reports and playbooks.

Key Features

    Real-time Ingestion: The application uses a background process to watch the ./logs/ directory. New files are automatically processed without requiring manual intervention.

    Extensible YARA Rules: You can easily add your own YARA rules to the ./rules/ directory to detect new threats. The application dynamically reloads rules upon a trigger.

    Data Persistence: All logs and alerts are stored in a SQLite database (siem.db), ensuring data is persistent across application restarts.

    AI-Powered Analysis: The integrated Gemini AI can provide a detailed analysis of an alert, including observations, impact assessment, and actionable recommendations.

How to Run the Project
1. Prerequisites

You need Python 3.7+ and a few Python libraries installed.

pip install Flask Flask-SQLAlchemy python-dotenv yara-python requests watchdog

2. Project Structure

Organize your project with the following directory structure:

    siem-project/

    ├── app.py                  # The main application file

    ├── .env                    # Environment variables (for your API key)

    ├── rules/                  # Directory for your YARA rules (.yara files)

    ├── logs/                   # Directory to drop log files for ingestion

    └── siem.db                 # The SQLite database file (auto-generated)

3. Configuration

Create a .env file in the root directory and add your Google API key.

GOOGLE_API_KEY="your_api_key_here"

4. Running the Application

Start the Flask application from your terminal.

python3 app.py

The application will automatically:

    Start a background process to monitor the ./logs/ directory.

    Serve the web dashboard at http://127.0.0.1:5000.

5. Using the Dashboard

Once the server is running, navigate to the dashboard in your web browser.

    Ingest: Drop your log files (e.g., .log, .json) into the ./logs/ directory. The application will automatically ingest them. You can use the Ingest button as a manual trigger if needed.

    Reload YARA: If you add or change any .yara rule files, click the Reload YARA button to re-compile the rules without restarting the server.

    Alerts: Any alerts that are triggered will appear on the main dashboard. Click on an alert to view its details.

    Analyze with Google AI: On the detailed alert page, click this button to get a professional incident report generated by Gemini AI.
